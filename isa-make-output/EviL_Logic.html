<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>
<title>Theory EviL_Logic (Isabelle2009-1: December 2009)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory EviL_Logic</h1>


<p><a href="index.html">Up</a> to index of Isabelle/HOL/EviL</p>
<span class="command">theory</span> <span class="name">EviL_Logic</span><br/>
<span class="keyword">imports</span> <a href="EviL_Semantics.html"><span class="name">EviL_Semantics</span></a><br/>

</div>
<hr/>
<div class="source">
<pre><span class="command_span"><span class="command">header</span><span class="verbatim">{* EviL Axiomatics *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">theory</span> <span class="ident">EviL_Logic</span>
<span class="keyword">imports</span> <span class="ident">EviL_Semantics</span>
<span class="keyword">begin</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{*
In this file, we turn to the task of providing
axiomatics for a Hilbert system giving the logic of EviL.  We shall
follow the treatment in Classic.thy, and instantiate EviL as a Classical
Logic. Since we'll continue the business of abusing notation, we first set our
notation appropriately. *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">no_notation</span>
  <span class="ident">bot</span> <span class="keyword">(</span><span class="string">&quot;&perp;&quot;</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">imp</span> <span class="keyword">(</span><span class="keyword">infixr</span> <span class="string">&quot;-&gt;&quot;</span> <span class="ident">25</span><span class="keyword">)</span>  <span class="keyword">and</span>
  <span class="ident">vdash</span> <span class="keyword">(</span><span class="string">&quot;\&lt;turnstile&gt; _&quot;</span> <span class="keyword">[</span><span class="ident">20</span><span class="keyword">]</span> <span class="ident">20</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">lift_vdash</span> <span class="keyword">(</span><span class="keyword">infix</span> <span class="string">&quot;:\&lt;turnstile&gt;&quot;</span> <span class="ident">10</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">lift_imp</span> <span class="keyword">(</span><span class="keyword">infix</span> <span class="string">&quot;:-&gt;&quot;</span> <span class="ident">24</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">Not</span>  <span class="keyword">(</span><span class="string">&quot;&not; _&quot;</span> <span class="keyword">[</span><span class="ident">40</span><span class="keyword">]</span> <span class="ident">40</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">neg</span> <span class="keyword">(</span><span class="string">&quot;&not; _&quot;</span> <span class="keyword">[</span><span class="ident">40</span><span class="keyword">]</span> <span class="ident">40</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">Classic.cl_neg</span> <span class="keyword">(</span><span class="string">&quot;&not; _&quot;</span> <span class="keyword">[</span><span class="ident">40</span><span class="keyword">]</span> <span class="ident">40</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">pneg</span> <span class="keyword">(</span><span class="string">&quot;&sim; _&quot;</span> <span class="keyword">[</span><span class="ident">40</span><span class="keyword">]</span> <span class="ident">40</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">cl_pneg</span> <span class="keyword">(</span><span class="string">&quot;&sim;&apos; _&quot;</span> <span class="keyword">[</span><span class="ident">40</span><span class="keyword">]</span> <span class="ident">40</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">CL_P</span> <span class="keyword">(</span><span class="string">"P#"</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">CL_Bot</span> <span class="keyword">(</span><span class="string">&quot;&perp;&quot;</span><span class="keyword">)</span> <span class="keyword">and</span>
  <span class="ident">CL_Imp</span> <span class="keyword">(</span><span class="keyword">infixr</span> <span class="string">&quot;-&gt;&quot;</span> <span class="ident">25</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">abbreviation</span>
<span class="ident">evil_neg</span> <span class="keyword">::</span> <span class="string">&quot;(&apos;a,&apos;b) evil_form =&gt; (&apos;a,&apos;b) evil_form&quot;</span> <span class="keyword">(</span><span class="string">&quot;&not; _&quot;</span> <span class="keyword">[</span><span class="ident">40</span><span class="keyword">]</span> <span class="ident">40</span><span class="keyword">)</span> <span class="keyword">where</span>
<span class="string">&quot;&not; &phi; &equiv; (&phi; -&gt; &perp;)&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">abbreviation</span>
<span class="ident">evil_D</span> <span class="keyword">::</span> <span class="string">&quot;&apos;b =&gt; (&apos;a,&apos;b) evil_form =&gt; (&apos;a,&apos;b) evil_form&quot;</span> <span class="keyword">(</span><span class="string">&quot;\&lt;diamond&gt;&quot;</span><span class="keyword">)</span> <span class="keyword">where</span>
<span class="string">&quot;\&lt;diamond&gt; X &phi; &equiv; &not; (\&lt;box&gt; X (&not; &phi;))&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">abbreviation</span>
<span class="ident">evil_DD</span> <span class="keyword">::</span> <span class="string">&quot;&apos;b =&gt; (&apos;a,&apos;b) evil_form =&gt; (&apos;a,&apos;b) evil_form&quot;</span> <span class="keyword">(</span><span class="string">&quot;&lang;+&rang;&quot;</span><span class="keyword">)</span> <span class="keyword">where</span>
<span class="string">&quot;&lang;+&rang; X &phi; &equiv; &not; ([+] X (&not; &phi;))&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">abbreviation</span>
<span class="ident">evil_DDI</span> <span class="keyword">::</span> <span class="string">&quot;&apos;b =&gt; (&apos;a,&apos;b) evil_form =&gt; (&apos;a,&apos;b) evil_form&quot;</span> <span class="keyword">(</span><span class="string">&quot;&lang;-&rang;&quot;</span><span class="keyword">)</span> <span class="keyword">where</span>
<span class="string">&quot;&lang;-&rang; X &phi; &equiv; &not; ([-] X (&not; &phi;))&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{*
  Here are the axioms of EviL; since these principles have their basis in
  philosophy, we offer philosophical readings of each.
*}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">inductive_set</span> <span class="ident">EviL</span> <span class="keyword">::</span> <span class="string">"('a,'b) evil_form set"</span> <span class="keyword">where</span> 
  <span class="keyword">--</span><span class="verbatim">{* If something is true, nothing can change this*}</span>
  <span class="ident">evil_ax1</span><span class="keyword">:</span> <span class="string">&quot;(&phi; -&gt; &psi; -&gt; &phi;) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If @{term &quot;&phi;&quot;} and @{term &quot;&psi;&quot;} jointly imply @{term &quot;&chi;&quot;},*}</span>
  <span class="keyword">--</span><span class="verbatim">{* and @{term &quot;&phi;&quot;} implies @{term &quot;&psi;&quot;}, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then @{term &quot;&phi;&quot;} alone is sufficient too show @{term &quot;&chi;&quot;} *}</span>
  <span class="ident">evil_ax2</span><span class="keyword">:</span> <span class="string">&quot;((&phi; -&gt; &psi; -&gt; &chi;) -&gt; (&phi; -&gt; &psi;) -&gt; (&phi; -&gt; &chi;)) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If the failure of @{term &quot;&phi;&quot;} ensures the failure of @{term &quot;&psi;&quot;}, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then @{term &quot;&psi;&quot;}&apos;s success ensures @{term &quot;&phi;&quot;}&apos;s success. *}</span>
  <span class="ident">evil_ax3</span><span class="keyword">:</span> <span class="string">&quot;((&not; &phi;  -&gt; &not; &psi;) -&gt; &psi; -&gt; &phi;) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If under any further evidence $X$ considers, @{term &quot;&phi;&quot;} holds, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then @{term &quot;&phi;&quot;} holds simpliciter, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* since considering no additional evidence is trivially considering further evidence *}</span>
  <span class="ident">evil_ax4</span><span class="keyword">:</span> <span class="string">&quot;([+] X &phi; -&gt; &phi;) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If under any further evidence $X$ considers,  @{term &quot;&phi;&quot;} holds, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then @{term &quot;&phi;&quot;} also holds whenever $X$ considers further further evidence. *}</span>
  <span class="ident">evil_ax5</span><span class="keyword">:</span> <span class="string">&quot;(([+] X &phi;) -&gt; ([+] X ([+] X &phi;))) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* Changing one's mind does not effect matters of fact *}</span>
  <span class="ident">evil_ax6</span><span class="keyword">:</span> <span class="string">&quot;(P# p -&gt; [+] X (P# p)) &isin; EviL&quot;</span> <span class="keyword">|</span>
  <span class="ident">evil_ax7</span><span class="keyword">:</span> <span class="string">&quot;(P# p -&gt; [-] X (P# p)) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* The more evidence $X$ discards,*}</span>
  <span class="keyword">--</span><span class="verbatim">{* the freer her imagination becomes. *}</span>
  <span class="ident">evil_ax8</span><span class="keyword">:</span> <span class="string">&quot;((\&lt;diamond&gt; X &phi;) -&gt; [-] X (\&lt;diamond&gt; X &phi;)) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If $X$ believes @{term &quot;&phi;&quot;}, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* she believes it despite what anyone thinks *}</span>
  <span class="ident">evil_ax9</span><span class="keyword">:</span> <span class="string">&quot;((\&lt;box&gt; X &phi;) -&gt; \&lt;box&gt; X ([+] Y &phi;)) &isin; EviL&quot;</span> <span class="keyword">|</span>
  <span class="ident">evil_ax10</span><span class="keyword">:</span> <span class="string">&quot;((\&lt;box&gt; X &phi;) -&gt; \&lt;box&gt; X ([-] Y &phi;)) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If $X$'s evidence is sound, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then what she believes is true *}</span>
  <span class="ident">evil_ax11</span><span class="keyword">:</span> <span class="string">&quot;(\&lt;odot&gt; X -&gt; (\&lt;box&gt; X &phi;) -&gt; &phi;) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If $X$'s evidence is sound, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then any subset of it she can consider must be sound too *}</span>
  <span class="ident">evil_ax12</span><span class="keyword">:</span> <span class="string">&quot;(\&lt;odot&gt; X -&gt; [-] X (\&lt;odot&gt; X)) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If @{term &quot;&phi;&quot;} is true, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then no matter what further evidence $X$ considers, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* she can forget it and @{term &quot;&phi;&quot;} will still be true *}</span>
  <span class="ident">evil_ax13</span><span class="keyword">:</span> <span class="string">&quot;(&phi; -&gt; [+] X (&lang;-&rang; X &phi;)) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If @{term &quot;&phi;&quot;} is true, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then no matter what evidence $X$ dispenses with, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* if $X$ remembers correctly then @{term &quot;&phi;&quot;} will still be true *}</span>
  <span class="ident">evil_ax14</span><span class="keyword">:</span> <span class="string">&quot;(&phi; -&gt; [-] X (&lang;+&rang;  X &phi;)) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If $X$ believes @{term &quot;&phi;&quot;} implies @{term &quot;&psi;&quot;} and @{term &quot;&phi;&quot;} *}</span>
  <span class="keyword">--</span><span class="verbatim">{* on the basis of her evidence, she can come to believe @{term &quot;&psi;&quot;} *}</span>
  <span class="keyword">--</span><span class="verbatim">{* on this same basis of her evidence. *}</span>
  <span class="ident">evil_ax15</span><span class="keyword">:</span> <span class="string">&quot;((\&lt;box&gt; X (&phi; -&gt; &psi;)) -&gt; (\&lt;box&gt; X &phi;) -&gt; \&lt;box&gt; X &psi;) &isin; EviL&quot;</span>  <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If no matter what evidence $X$ tries to forget, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* @{term &quot;&phi;&quot;} implies @{term &quot;&psi;&quot;}, and also @{term &quot;&phi;&quot;} holds, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then no matter what evidence she disregards it must be that @{term &quot;&psi;&quot;}. *}</span>
  <span class="ident">evil_ax16</span><span class="keyword">:</span> <span class="string">&quot;(([-] X (&phi; -&gt; &psi;)) -&gt; ([-] X &phi;) -&gt; [-] X &psi;) &isin; EviL&quot;</span>  <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If no matter what further evidence $X$ considers, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* @{term &quot;&phi;&quot;} implies @{term &quot;&psi;&quot;}, and also @{term &quot;&phi;&quot;} holds, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then no matter what further evidence she consider it must be that @{term &quot;&psi;&quot;}. *}</span>
  <span class="ident">evil_ax17</span><span class="keyword">:</span> <span class="string">&quot;(([+] X (&phi; -&gt; &psi;)) -&gt; ([+] X &phi;) -&gt; [+] X &psi;) &isin; EviL&quot;</span>  <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If something is always true, then an agent can come to believe this *}</span>
  <span class="ident">evil_B_nec</span><span class="keyword">:</span> <span class="string">&quot;&phi; &isin; EviL ==&gt; (\&lt;box&gt; X &phi;) &isin; EviL&quot;</span> <span class="keyword">|</span>
  
  <span class="keyword">--</span><span class="verbatim">{* If something is always true, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then it's true no matter what an agent tries to forget *}</span>
  <span class="ident">evil_BB_nec</span><span class="keyword">:</span> <span class="string">&quot;&phi; &isin; EviL ==&gt; ([-] X &phi;) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* If something is always true, *}</span>
  <span class="keyword">--</span><span class="verbatim">{* then it's true regardless of what more an agent might choose to believe *}</span>
  <span class="ident">evil_BBI_nec</span><span class="keyword">:</span> <span class="string">&quot;&phi; &isin; EviL ==&gt; ([+] X &phi;) &isin; EviL&quot;</span> <span class="keyword">|</span>

  <span class="keyword">--</span><span class="verbatim">{* Modus ponens *}</span>
  <span class="ident">evil_mp</span><span class="keyword">:</span> <span class="string">&quot;[| (&phi; -&gt; &psi;) &isin; EviL; &phi; &isin; EviL |] ==&gt; &psi; &isin; EviL&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">abbreviation</span> <span class="ident">evil_vdash</span> <span class="keyword">::</span> <span class="string">&quot;(&apos;a,&apos;b) evil_form =&gt; bool&quot;</span> <span class="keyword">(</span><span class="string">&quot;\&lt;turnstile&gt; _&quot;</span> <span class="keyword">[</span><span class="ident">20</span><span class="keyword">]</span> <span class="ident">20</span><span class="keyword">)</span> <span class="keyword">where</span>
<span class="string">&quot;(\&lt;turnstile&gt; &phi;) &equiv; &phi; &isin; EviL&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{* It's natural to want to prove soundness after introducing all of these axioms.
        The proof is completely mechanical: *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">theorem</span> <span class="ident">evil_soundness</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; ==&gt; &forall; (a,A) &isin; &Omega;. &Omega;,(a,A) |\&lt;Turnstile&gt; &phi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">set</span><span class="keyword">:</span> <span class="ident">EviL</span><span class="keyword">,</span> <span class="keyword">(</span><span class="ident">simp</span> <span class="ident">add</span><span class="keyword">:</span> <span class="ident">Ball_def</span><span class="keyword">|</span><span class="ident">blast</span><span class="keyword">)</span><span class="keyword">+</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">theorem</span> <span class="ident">evil_consistency</span><span class="keyword">:</span> <span class="string">&quot;~ (\&lt;turnstile&gt; &perp;)&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">let</span> <span class="var">?&Omega;</span><span class="keyword">=</span><span class="string">&quot;{({},(%b &phi;. False))}&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;~(&forall; (a,A) &isin; ?&Omega;. ?&Omega;,(a,A) |\&lt;Turnstile&gt; &perp;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_soundness</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&Omega;</span><span class="keyword">=</span><span class="string">&quot;?&Omega;&quot;</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&perp;&quot;</span><span class="keyword">]</span></span><span class="ignored_span"> 
  </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{* We now turn to developing some basic proof theory for EviL.  We start
by showing that it is an extesion of classical logic; it is in fact a conservative
extension (we assert this without proof).  So we shall establish that it is an 
instance of ClassAx. *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">interpretation</span> <span class="ident">evil_ClassAx</span><span class="keyword">:</span> <span class="ident">ClassAx</span> <span class="string">&quot;op -&gt;&quot;</span> <span class="string">"evil_vdash"</span> <span class="string">&quot;&perp;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">qed</span> <span class="keyword">(</span><span class="ident">fastsimp</span> <span class="ident">intro</span><span class="keyword">:</span> <span class="ident">EviL.intros</span><span class="keyword">)</span><span class="keyword">+</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{* In the subsequent discussion, we'll have need to prove a lot of theorems in 
classical propositional logic; our basic approach will be to appeal to completeness
and apply automation to accomplish this. So we now reintroduce syntax for classical
logic. *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">notation</span>
<span class="ident">CL_P</span>     <span class="keyword">(</span><span class="string">&quot;P#<sub>CL</sub>&quot;</span><span class="keyword">)</span> <span class="keyword">and</span>
<span class="ident">CL_Bot</span>   <span class="keyword">(</span><span class="string">&quot;&perp;<sub>CL</sub>&quot;</span><span class="keyword">)</span>  <span class="keyword">and</span>
<span class="ident">cl_neg</span>   <span class="keyword">(</span><span class="string">&quot;&not;<sub>CL</sub>&quot;</span><span class="keyword">)</span>  <span class="keyword">and</span>
<span class="ident">CL_Imp</span>   <span class="keyword">(</span><span class="keyword">infixr</span> <span class="string">&quot;-&gt;<sub>CL</sub>&quot;</span> <span class="ident">25</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{* Our first application of this approach will be to prove a rewrite rule for
EviL; we shall have intend to appeal to rewriting further on in our proof *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">primrec</span> <span class="ident">evil_sub</span> <span class="keyword">::</span> 
 <span class="string">&quot;[(&apos;a,&apos;b) evil_form, (&apos;a,&apos;b) evil_form, (&apos;a,&apos;b) evil_form] 
            =&gt; (&apos;a,&apos;b) evil_form&quot;</span> <span class="keyword">(</span><span class="string">"_[_'/_]"</span> <span class="keyword">[</span><span class="ident">300</span><span class="keyword">,</span> <span class="ident">0</span><span class="keyword">,</span> <span class="ident">0</span><span class="keyword">]</span> <span class="ident">300</span><span class="keyword">)</span> <span class="keyword">where</span>
     <span class="string">&quot;(P# a)[&phi;/&psi;] = (if ((P# a) = &phi;) then &psi; else (P# a))&quot;</span>
   <span class="keyword">|</span> <span class="string">&quot;&perp;[&phi;/&psi;] = (if (&perp; = &phi;) then &psi; else &perp;)&quot;</span>
   <span class="keyword">|</span> <span class="string">&quot;(\&lt;odot&gt; X)[&phi;/&psi;] = (if ((\&lt;odot&gt; X) = &phi;) then &psi; else (\&lt;odot&gt; X))&quot;</span>
   <span class="keyword">|</span> <span class="string">&quot;(&delta; -&gt; &kappa;)[&phi;/&psi;] = (if ((&delta; -&gt; &kappa;) = &phi;) then &psi; 
                        else (&delta;[&phi;/&psi;] -&gt; &kappa;[&phi;/&psi;]))&quot;</span>
   <span class="keyword">|</span> <span class="string">&quot;(\&lt;box&gt; X &kappa;)[&phi;/&psi;] = (if ((\&lt;box&gt; X &kappa;) = &phi;) then &psi;
                      else (\&lt;box&gt; X (&kappa;[&phi;/&psi;])))&quot;</span>
   <span class="keyword">|</span> <span class="string">&quot;([-] X &kappa;)[&phi;/&psi;] = (if (([-] X &kappa;) = &phi;) then &psi; 
                        else ([-] X (&kappa;[&phi;/&psi;])))&quot;</span>
   <span class="keyword">|</span> <span class="string">&quot;([+] X &kappa;)[&phi;/&psi;] = (if (([+] X &kappa;) = &phi;) then &psi; 
                        else ([+] X (&kappa;[&phi;/&psi;])))&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">abbreviation</span> <span class="ident">evil_iff</span> <span class="keyword">::</span> 
  <span class="string">&quot;[(&apos;a,&apos;b) evil_form, (&apos;a,&apos;b) evil_form] 
   =&gt; (&apos;a,&apos;b) evil_form&quot;</span> <span class="keyword">(</span><span class="keyword">infixr</span> <span class="string">&quot;\&lt;leftrightarrow&gt;&quot;</span> <span class="ident">25</span><span class="keyword">)</span> <span class="keyword">where</span>
<span class="string">&quot;(&phi; \&lt;leftrightarrow&gt; &psi;) &equiv; ((&phi; -&gt; &not; &psi;) -&gt; &not;(&not; &phi; -&gt; &psi;))&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">abbreviation</span> <span class="ident">cl_iff</span> <span class="keyword">::</span> 
  <span class="string">&quot;[&apos;a cl_form, &apos;a cl_form] =&gt; &apos;a cl_form&quot;</span> <span class="keyword">(</span><span class="keyword">infixr</span> <span class="string">&quot;\&lt;leftrightarrow&gt;<sub>CL</sub>&quot;</span> <span class="ident">25</span><span class="keyword">)</span> <span class="keyword">where</span>
<span class="string">&quot;(&phi; \&lt;leftrightarrow&gt;<sub>CL</sub> &psi;) &equiv; ((&phi; -&gt;<sub>CL</sub> &not;<sub>CL</sub> &psi;) -&gt;<sub>CL</sub> &not;<sub>CL</sub> (&not;<sub>CL</sub> &phi; -&gt;<sub>CL</sub> &psi;))&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{* As the following shows, most elementary theorems
about logical equivalence reflect tautologies from classical
propositional logic; having automated semantics and completeness
makes this work rather straightforward. *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_eq_refl</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &phi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt;<sub>CL</sub> (P#<sub>CL</sub> &phi;) \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.cl_translate</span>
       <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;(P#<sub>CL</sub> &phi;) \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> &phi;)&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_eq_symm</span> <span class="keyword">[</span><span class="ident">sym</span><span class="keyword">]</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi; ==&gt; \&lt;turnstile&gt; &psi; \&lt;leftrightarrow&gt; &phi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="ident">eq</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span> <span class="keyword">=</span> <span class="string">&quot;((P#<sub>CL</sub> &phi;) \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> &psi;)) 
            -&gt;<sub>CL</sub> ((P#<sub>CL</sub> &psi;) \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> &phi;))&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; (&phi; \&lt;leftrightarrow&gt; &psi;) -&gt; (&psi; \&lt;leftrightarrow&gt; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_mp</span> <span class="ident">eq</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_eq_trans</span><span class="keyword">:</span> 
  <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi; ==&gt; \&lt;turnstile&gt; &psi; \&lt;leftrightarrow&gt; &chi; ==&gt; \&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &chi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="ident">A</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi;&quot;</span>
     <span class="keyword">and</span> <span class="ident">B</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &psi; \&lt;leftrightarrow&gt; &chi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span> <span class="keyword">=</span> <span class="string">&quot;((P#<sub>CL</sub> &phi;) \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> &psi;)) 
            -&gt;<sub>CL</sub> ((P#<sub>CL</sub> &psi;) \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> &chi;))
            -&gt;<sub>CL</sub> ((P#<sub>CL</sub> &phi;) \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> &chi;))&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; (&phi; \&lt;leftrightarrow&gt; &psi;) -&gt; (&psi; \&lt;leftrightarrow&gt; &chi;) -&gt; (&phi; \&lt;leftrightarrow&gt; &chi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_mp</span> <span class="ident">A</span> <span class="ident">B</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{* One should note that the above three lemmas 
establish that @{term &quot;op \&lt;leftrightarrow&gt;&quot;} is an equivalence relation,
which is of course an elementary result in basic logic. *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_eq_weaken</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi; ==&gt; \&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="ident">eq</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span> <span class="keyword">=</span> <span class="string">&quot;((P#<sub>CL</sub> &phi;) \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> &psi;)) -&gt;<sub>CL</sub> 
                (P#<sub>CL</sub> &phi;) -&gt;<sub>CL</sub> (P#<sub>CL</sub> &psi;)&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; (&phi; \&lt;leftrightarrow&gt; &psi;) -&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_mp</span> <span class="ident">eq</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_eq_mp</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi; ==&gt; \&lt;turnstile&gt; &phi; ==&gt; \&lt;turnstile&gt; &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="ident">eq</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi;&quot;</span> <span class="keyword">and</span> <span class="ident">hyp</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_eq_weaken</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_mp</span> <span class="ident">hyp</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_eq_intro</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi; ==&gt; \&lt;turnstile&gt; &psi; -&gt; &phi; ==&gt; \&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="ident">A</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span>
     <span class="keyword">and</span> <span class="ident">B</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &psi; -&gt; &phi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span><span class="keyword">=</span><span class="string">&quot;(P#<sub>CL</sub> &phi; -&gt;<sub>CL</sub> P#<sub>CL</sub> &psi;)
          -&gt;<sub>CL</sub> (P#<sub>CL</sub> &psi; -&gt;<sub>CL</sub> P#<sub>CL</sub> &phi;)
          -&gt;<sub>CL</sub> (P#<sub>CL</sub> &phi; \&lt;leftrightarrow&gt;<sub>CL</sub> P#<sub>CL</sub> &psi;)&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; (&phi; -&gt; &psi;) -&gt; (&psi; -&gt; &phi;) -&gt; (&phi; \&lt;leftrightarrow&gt; &psi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">A</span> <span class="ident">B</span> <span class="ident">evil_mp</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_contrapose</span><span class="keyword">:</span>
  <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi; ==&gt; \&lt;turnstile&gt; &not; &psi; -&gt; &not; &phi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span><span class="keyword">=</span><span class="string">&quot;(P#<sub>CL</sub> &phi; -&gt;<sub>CL</sub> P#<sub>CL</sub> &psi;)
          -&gt;<sub>CL</sub> (&not;<sub>CL</sub> (P#<sub>CL</sub> &psi;) -&gt;<sub>CL</sub> &not;<sub>CL</sub> (P#<sub>CL</sub> &phi;))&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; (&phi; -&gt; &psi;) -&gt; (&not; &psi; -&gt; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span> <span class="ident">evil_mp</span></span><span class="ignored_span"> 
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">notation</span>
  <span class="ident">evil_ClassAx.lift_imp</span> <span class="keyword">(</span><span class="keyword">infix</span> <span class="string">&quot;:-&gt;&quot;</span> <span class="ident">24</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">abbreviation</span> <span class="ident">evil_lift_vdash</span> <span class="keyword">::</span> 
   <span class="string">&quot;(&apos;a,&apos;b) evil_form list 
    =&gt; (&apos;a,&apos;b) evil_form =&gt; bool&quot;</span> <span class="keyword">(</span><span class="keyword">infix</span> <span class="string">&quot;:\&lt;turnstile&gt;&quot;</span> <span class="ident">10</span><span class="keyword">)</span> <span class="keyword">where</span>
  <span class="string">&quot;(&Gamma; :\&lt;turnstile&gt; &phi;) &equiv; (\&lt;turnstile&gt; &Gamma; :-&gt; &phi;)&quot;</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_B_map</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi; ==&gt; \&lt;turnstile&gt; \&lt;box&gt; X &phi; -&gt; \&lt;box&gt; X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_B_nec</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;box&gt; X (&phi; -&gt; &psi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax15</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span> <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&psi;&quot;</span><span class="keyword">]</span>
       <span class="ident">evil_mp</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_lift_ax15</span><span class="keyword">:</span> 
   <span class="keyword">assumes</span> <span class="ident">notnil</span><span class="keyword">:</span> <span class="string">&quot;&phi;s &ne; []&quot;</span>
     <span class="keyword">shows</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;box&gt; X (&phi;s :-&gt; &psi;) 
              -&gt; ((map (&lambda; &phi;. \&lt;box&gt; X &phi;) &phi;s) :-&gt; \&lt;box&gt; X &psi;)&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">notnil</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">case</span> <span class="ident">Nil</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">Cons</span> <span class="ident">&phi;</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">note</span> <span class="ident">ind_hyp</span> <span class="keyword">=</span> <span class="ident">this</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">proof</span> <span class="ident">cases</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;&phi;s = []&quot;</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax15</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> 
    </span><span class="command_span"><span class="command">let</span> <span class="var">?A</span> <span class="keyword">=</span> <span class="string">&quot;\&lt;box&gt; X ((&phi; # &phi;s) :-&gt; &psi;)&quot;</span>
    <span class="keyword">and</span> <span class="var">?B</span> <span class="keyword">=</span> <span class="string">&quot;\&lt;box&gt; X &phi;&quot;</span>
    <span class="keyword">and</span> <span class="var">?C</span> <span class="keyword">=</span> <span class="string">&quot;\&lt;box&gt; X (&phi;s :-&gt; &psi;)&quot;</span>
    <span class="keyword">and</span> <span class="var">?D</span> <span class="keyword">=</span> <span class="string">&quot;((map (&lambda; &phi;. \&lt;box&gt; X &phi;) &phi;s) :-&gt; \&lt;box&gt; X &psi;)&quot;</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">assume</span> <span class="ident">notnil</span><span class="keyword">:</span> <span class="string">&quot;&phi;s &ne; []&quot;</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">ind_hyp</span>
           <span class="ident">evil_ClassAx.lift</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&Gamma;</span><span class="keyword">=</span><span class="string">"[?A]"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">have</span> <span class="ident">map</span><span class="keyword">:</span> <span class="string">&quot;[?A] :\&lt;turnstile&gt; ?C -&gt; ?D&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">from</span> <span class="ident">evil_ax15</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;[?A] :\&lt;turnstile&gt; ?B -&gt; ?C&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">map</span>
           <span class="ident">evil_ClassAx.lift_hs</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&Gamma;</span><span class="keyword">=</span><span class="string">"[?A]"</span>
                                   <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">"?B"</span>
                                   <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">"?C"</span>
                                   <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">"?D"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_B_lift_map</span><span class="keyword">:</span>
 <span class="keyword">assumes</span> <span class="ident">seq</span><span class="keyword">:</span> <span class="string">&quot;&phi;s :\&lt;turnstile&gt; &psi;&quot;</span>
   <span class="keyword">shows</span> <span class="string">&quot;(map (&lambda; &phi;. \&lt;box&gt; X &phi;) &phi;s) :\&lt;turnstile&gt; \&lt;box&gt; X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">seq</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">case</span> <span class="ident">Nil</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_B_nec</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">Cons</span> <span class="ident">&phi;</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_B_nec</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;(&phi; # &phi;s) :-&gt; &psi;&quot;</span><span class="keyword">]</span>
         <span class="ident">evil_mp</span>
         <span class="ident">evil_lift_ax15</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span>
                           <span class="keyword">and</span> <span class="ident">&phi;s</span><span class="keyword">=</span><span class="string">&quot;&phi; # &phi;s&quot;</span>
                           <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&psi;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_DB_map</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi; ==&gt; \&lt;turnstile&gt; \&lt;diamond&gt; X &phi; -&gt; \&lt;diamond&gt; X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_contrapose</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &not; &psi; -&gt; &not; &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_B_map</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;box&gt; X (&not; &psi;) -&gt; \&lt;box&gt; X (&not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_contrapose</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BB_map</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi; ==&gt; \&lt;turnstile&gt; [-] X &phi; -&gt; [-] X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_BB_nec</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [-] X (&phi; -&gt; &psi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax16</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span> <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&psi;&quot;</span><span class="keyword">]</span>
       <span class="ident">evil_mp</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_lift_ax16</span><span class="keyword">:</span> 
   <span class="keyword">assumes</span> <span class="ident">notnil</span><span class="keyword">:</span> <span class="string">&quot;&phi;s &ne; []&quot;</span>
     <span class="keyword">shows</span> <span class="string">&quot;\&lt;turnstile&gt; [-] X (&phi;s :-&gt; &psi;) 
              -&gt; ((map (&lambda; &phi;. [-] X &phi;) &phi;s) :-&gt; [-] X &psi;)&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">notnil</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">case</span> <span class="ident">Nil</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">Cons</span> <span class="ident">&phi;</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">note</span> <span class="ident">ind_hyp</span> <span class="keyword">=</span> <span class="ident">this</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">proof</span> <span class="ident">cases</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;&phi;s = []&quot;</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax16</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> 
    </span><span class="command_span"><span class="command">let</span> <span class="var">?A</span> <span class="keyword">=</span> <span class="string">&quot;[-] X ((&phi; # &phi;s) :-&gt; &psi;)&quot;</span>
    <span class="keyword">and</span> <span class="var">?B</span> <span class="keyword">=</span> <span class="string">&quot;[-] X &phi;&quot;</span>
    <span class="keyword">and</span> <span class="var">?C</span> <span class="keyword">=</span> <span class="string">&quot;[-] X (&phi;s :-&gt; &psi;)&quot;</span>
    <span class="keyword">and</span> <span class="var">?D</span> <span class="keyword">=</span> <span class="string">&quot;((map (&lambda; &phi;. [-] X &phi;) &phi;s) :-&gt; [-] X &psi;)&quot;</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">assume</span> <span class="ident">notnil</span><span class="keyword">:</span> <span class="string">&quot;&phi;s &ne; []&quot;</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">ind_hyp</span>
           <span class="ident">evil_ClassAx.lift</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&Gamma;</span><span class="keyword">=</span><span class="string">"[?A]"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">have</span> <span class="ident">map</span><span class="keyword">:</span> <span class="string">&quot;[?A] :\&lt;turnstile&gt; ?C -&gt; ?D&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">from</span> <span class="ident">evil_ax16</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;[?A] :\&lt;turnstile&gt; ?B -&gt; ?C&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">map</span>
           <span class="ident">evil_ClassAx.lift_hs</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&Gamma;</span><span class="keyword">=</span><span class="string">"[?A]"</span>
                                   <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">"?B"</span>
                                   <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">"?C"</span>
                                   <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">"?D"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BB_lift_map</span><span class="keyword">:</span>
 <span class="keyword">assumes</span> <span class="ident">seq</span><span class="keyword">:</span> <span class="string">&quot;&phi;s :\&lt;turnstile&gt; &psi;&quot;</span>
   <span class="keyword">shows</span> <span class="string">&quot;(map (&lambda; &phi;. [-] X &phi;) &phi;s) :\&lt;turnstile&gt; [-] X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">seq</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">case</span> <span class="ident">Nil</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_BB_nec</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">Cons</span> <span class="ident">&phi;</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_BB_nec</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;(&phi; # &phi;s) :-&gt; &psi;&quot;</span><span class="keyword">]</span>
         <span class="ident">evil_mp</span>
         <span class="ident">evil_lift_ax16</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span>
                           <span class="keyword">and</span> <span class="ident">&phi;s</span><span class="keyword">=</span><span class="string">&quot;&phi; # &phi;s&quot;</span>
                           <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&psi;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_DBB_map</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi; ==&gt; \&lt;turnstile&gt; &lang;-&rang; X &phi; -&gt; &lang;-&rang; X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_contrapose</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &not; &psi; -&gt; &not; &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_BB_map</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [-] X (&not; &psi;) -&gt; [-] X (&not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_contrapose</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BBI_map</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi; ==&gt; \&lt;turnstile&gt; [+] X &phi; -&gt; [+] X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_BBI_nec</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [+] X (&phi; -&gt; &psi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax17</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span> <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&psi;&quot;</span><span class="keyword">]</span>
       <span class="ident">evil_mp</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_lift_ax17</span><span class="keyword">:</span> 
   <span class="keyword">assumes</span> <span class="ident">notnil</span><span class="keyword">:</span> <span class="string">&quot;&phi;s &ne; []&quot;</span>
     <span class="keyword">shows</span> <span class="string">&quot;\&lt;turnstile&gt; [+] X (&phi;s :-&gt; &psi;) 
              -&gt; ((map (&lambda; &phi;. [+] X &phi;) &phi;s) :-&gt; [+] X &psi;)&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">notnil</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">case</span> <span class="ident">Nil</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">Cons</span> <span class="ident">&phi;</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">note</span> <span class="ident">ind_hyp</span> <span class="keyword">=</span> <span class="ident">this</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">proof</span> <span class="ident">cases</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;&phi;s = []&quot;</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax17</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> 
    </span><span class="command_span"><span class="command">let</span> <span class="var">?A</span> <span class="keyword">=</span> <span class="string">&quot;[+] X ((&phi; # &phi;s) :-&gt; &psi;)&quot;</span>
    <span class="keyword">and</span> <span class="var">?B</span> <span class="keyword">=</span> <span class="string">&quot;[+] X &phi;&quot;</span>
    <span class="keyword">and</span> <span class="var">?C</span> <span class="keyword">=</span> <span class="string">&quot;[+] X (&phi;s :-&gt; &psi;)&quot;</span>
    <span class="keyword">and</span> <span class="var">?D</span> <span class="keyword">=</span> <span class="string">&quot;((map (&lambda; &phi;. [+] X &phi;) &phi;s) :-&gt; [+] X &psi;)&quot;</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">assume</span> <span class="ident">notnil</span><span class="keyword">:</span> <span class="string">&quot;&phi;s &ne; []&quot;</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">ind_hyp</span>
           <span class="ident">evil_ClassAx.lift</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&Gamma;</span><span class="keyword">=</span><span class="string">"[?A]"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">have</span> <span class="ident">map</span><span class="keyword">:</span> <span class="string">&quot;[?A] :\&lt;turnstile&gt; ?C -&gt; ?D&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">from</span> <span class="ident">evil_ax17</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;[?A] :\&lt;turnstile&gt; ?B -&gt; ?C&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">with</span> <span class="ident">map</span>
           <span class="ident">evil_ClassAx.lift_hs</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&Gamma;</span><span class="keyword">=</span><span class="string">"[?A]"</span>
                                   <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">"?B"</span>
                                   <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">"?C"</span>
                                   <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">"?D"</span><span class="keyword">]</span></span><span class="ignored_span">
        </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BBI_lift_map</span><span class="keyword">:</span>
 <span class="keyword">assumes</span> <span class="ident">seq</span><span class="keyword">:</span> <span class="string">&quot;&phi;s :\&lt;turnstile&gt; &psi;&quot;</span>
   <span class="keyword">shows</span> <span class="string">&quot;(map (&lambda; &phi;. [+] X &phi;) &phi;s) :\&lt;turnstile&gt; [+] X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">seq</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">case</span> <span class="ident">Nil</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_BBI_nec</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">Cons</span> <span class="ident">&phi;</span> <span class="ident">&phi;s</span><span class="keyword">)</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_BBI_nec</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;(&phi; # &phi;s) :-&gt; &psi;&quot;</span><span class="keyword">]</span>
         <span class="ident">evil_mp</span>
         <span class="ident">evil_lift_ax17</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span>
                           <span class="keyword">and</span> <span class="ident">&phi;s</span><span class="keyword">=</span><span class="string">&quot;&phi; # &phi;s&quot;</span>
                           <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&psi;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_DBBI_map</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi; ==&gt; \&lt;turnstile&gt; &lang;+&rang; X &phi; -&gt; &lang;+&rang; X &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">assume</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; &psi;&quot;</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_contrapose</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &not; &psi; -&gt; &not; &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_BBI_map</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [+] X (&not; &psi;) -&gt; [+] X (&not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_contrapose</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_sub</span><span class="keyword">:</span> 
  <span class="keyword">assumes</span> <span class="ident">eq</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; \&lt;leftrightarrow&gt; &psi;&quot;</span> 
  <span class="keyword">shows</span> <span class="string">&quot;\&lt;turnstile&gt; &chi; \&lt;leftrightarrow&gt; &chi;[&phi;/&psi;]&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">eq</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&chi;</span><span class="keyword">,</span> <span class="keyword">(</span><span class="ident">fastsimp</span> <span class="ident">intro</span><span class="keyword">:</span> <span class="ident">evil_eq_refl</span><span class="keyword">)</span><span class="keyword">+</span><span class="keyword">)</span>
  <span class="keyword">--</span><span class="string">"Most cases are delt with automatically;"</span>
  <span class="keyword">--</span><span class="string">"we are left with implication and the three boxes"</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_Imp</span> <span class="ident">&delta;</span> <span class="ident">&kappa;</span><span class="keyword">)</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">hence</span> <span class="ident">A</span><span class="keyword">:</span> <span class="string">&quot;(\&lt;turnstile&gt; &delta; \&lt;leftrightarrow&gt; &delta;[&phi;/&psi;])&quot;</span> 
      <span class="keyword">and</span> <span class="ident">B</span><span class="keyword">:</span> <span class="string">&quot;(\&lt;turnstile&gt; &kappa; \&lt;leftrightarrow&gt; &kappa;[&phi;/&psi;])&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span><span class="keyword">+</span>
    <span class="keyword">--</span><span class="string">"This case follows from a lengthy tautology"</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span><span class="keyword">=</span><span class="string">&quot;(P#<sub>CL</sub> &delta; \&lt;leftrightarrow&gt;<sub>CL</sub> P#<sub>CL</sub> (&delta;[&phi;/&psi;]))
          -&gt;<sub>CL</sub> (P#<sub>CL</sub> &kappa; \&lt;leftrightarrow&gt;<sub>CL</sub> P#<sub>CL</sub> (&kappa;[&phi;/&psi;])) 
          -&gt;<sub>CL</sub> ((P#<sub>CL</sub> &delta; -&gt;<sub>CL</sub> P#<sub>CL</sub> &kappa;) 
                 \&lt;leftrightarrow&gt;<sub>CL</sub> (P#<sub>CL</sub> (&delta;[&phi;/&psi;]) -&gt;<sub>CL</sub> P#<sub>CL</sub> (&kappa;[&phi;/&psi;])))&quot;</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; (&delta; \&lt;leftrightarrow&gt; &delta;[&phi;/&psi;]) -&gt; (&kappa; \&lt;leftrightarrow&gt; &kappa; [&phi;/&psi;])
             -&gt; ((&delta; -&gt; &kappa;) \&lt;leftrightarrow&gt; (&delta;[&phi;/&psi;] -&gt; &kappa;[&phi;/&psi;]))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span"> 
    </span><span class="command_span"><span class="command">with</span> <span class="ident">A</span> <span class="ident">evil_mp</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&delta; \&lt;leftrightarrow&gt; &delta;[&phi;/&psi;]&quot;</span><span class="keyword">]</span>
         <span class="ident">B</span> <span class="ident">evil_mp</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&kappa; \&lt;leftrightarrow&gt; &kappa;[&phi;/&psi;]&quot;</span><span class="keyword">]</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span>
      <span class="string">&quot;\&lt;turnstile&gt; (&delta; -&gt; &kappa;) \&lt;leftrightarrow&gt; (&delta;[&phi;/&psi;] -&gt; &kappa;[&phi;/&psi;])&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">eq</span> <span class="ident">evil_eq_refl</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span>

  <span class="keyword">--</span><span class="string">"The next three cases are all basically the same"</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_B</span> <span class="ident">X</span> <span class="ident">&chi;</span><span class="keyword">)</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">hence</span> <span class="ident">A</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &chi; \&lt;leftrightarrow&gt; &chi;[&phi;/&psi;]&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">from</span> <span class="ident">A</span> <span class="ident">evil_eq_weaken</span> <span class="ident">evil_B_map</span></span><span class="ignored_span"> 
      </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;box&gt; X &chi; -&gt; \&lt;box&gt; X (&chi;[&phi;/&psi;])&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">from</span> <span class="ident">A</span> <span class="ident">evil_eq_symm</span> <span class="ident">evil_eq_weaken</span> <span class="ident">evil_B_map</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;box&gt; X (&chi;[&phi;/&psi;]) -&gt; \&lt;box&gt; X &chi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span> <span class="ident">evil_eq_intro</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;box&gt; X &chi; \&lt;leftrightarrow&gt; \&lt;box&gt; X (&chi;[&phi;/&psi;])&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">eq</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_BB</span> <span class="ident">X</span> <span class="ident">&chi;</span><span class="keyword">)</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">hence</span> <span class="ident">A</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &chi; \&lt;leftrightarrow&gt; &chi;[&phi;/&psi;]&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">from</span> <span class="ident">A</span> <span class="ident">evil_eq_weaken</span> <span class="ident">evil_BB_map</span></span><span class="ignored_span"> 
      </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [-] X &chi; -&gt; [-] X (&chi;[&phi;/&psi;])&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">from</span> <span class="ident">A</span> <span class="ident">evil_eq_symm</span> <span class="ident">evil_eq_weaken</span> <span class="ident">evil_BB_map</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [-] X (&chi;[&phi;/&psi;]) -&gt; [-] X &chi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span> <span class="ident">evil_eq_intro</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [-] X &chi; \&lt;leftrightarrow&gt; [-] X (&chi;[&phi;/&psi;])&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">eq</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_BBI</span> <span class="ident">X</span> <span class="ident">&chi;</span><span class="keyword">)</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">hence</span> <span class="ident">A</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &chi; \&lt;leftrightarrow&gt; &chi;[&phi;/&psi;]&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">from</span> <span class="ident">A</span> <span class="ident">evil_eq_weaken</span> <span class="ident">evil_BBI_map</span></span><span class="ignored_span"> 
      </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [+] X &chi; -&gt; [+] X (&chi;[&phi;/&psi;])&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">from</span> <span class="ident">A</span> <span class="ident">evil_eq_symm</span> <span class="ident">evil_eq_weaken</span> <span class="ident">evil_BBI_map</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [+] X (&chi;[&phi;/&psi;]) -&gt; [+] X &chi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span> <span class="ident">evil_eq_intro</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; [+] X &chi; \&lt;leftrightarrow&gt; [+] X (&chi;[&phi;/&psi;])&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">eq</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{* The substitution theorem above, while popular in the literature, is not rigorous.
        Since it relies on pattern matching, authors play faster and looser with it than
        other tasks.
        
        However, we can show that substitution never changes proper subformulae of the thing
        being substituted.  In every instance of substitution we shall employ, this fact is
        what suffices to make substitution really applicable. *}</span>

<span class="keyword">--</span><span class="string">"A little function which gives the proper subforumulae"</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">primrec</span> <span class="ident">evil_psubforms</span> 
 <span class="keyword">::</span> <span class="string">&quot;(&apos;a,&apos;b) evil_form =&gt; (&apos;a,&apos;b) evil_form set&quot;</span> <span class="keyword">(</span><span class="string">&quot;\&lt;Down&gt;&quot;</span><span class="keyword">)</span>
<span class="keyword">where</span>
    <span class="string">&quot;\&lt;Down&gt;(P# p) = {}&quot;</span>
  <span class="keyword">|</span> <span class="string">&quot;\&lt;Down&gt;(&perp;) = {}&quot;</span>
  <span class="keyword">|</span> <span class="string">&quot;\&lt;Down&gt;(\&lt;odot&gt; X) = {}&quot;</span>
  <span class="keyword">|</span> <span class="string">&quot;\&lt;Down&gt;(&phi; -&gt; &psi;) = {&phi;, &psi;} &cup; \&lt;Down&gt;(&phi;) &cup; \&lt;Down&gt;(&psi;)&quot;</span>
  <span class="keyword">|</span> <span class="string">&quot;\&lt;Down&gt;(\&lt;box&gt; X &phi;) = {&phi;} &cup;  \&lt;Down&gt;(&phi;)&quot;</span>
  <span class="keyword">|</span> <span class="string">&quot;\&lt;Down&gt;([-] X &phi;) = {&phi;} &cup;  \&lt;Down&gt;(&phi;)&quot;</span>
  <span class="keyword">|</span> <span class="string">&quot;\&lt;Down&gt;([+] X &phi;) = {&phi;} &cup;  \&lt;Down&gt;(&phi;)&quot;</span>

<span class="keyword">--</span><span class="string">"Here's a series of obvious inequalities we shall reuse"</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_limp_neq</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> <span class="string">&quot;&forall; &chi;. (&psi; -&gt; &chi;) &ne; &psi;&quot;</span></span><span class="ignored_span"> 
  </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&psi;</span><span class="keyword">,</span> <span class="ident">simp_all</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_rimp_neq</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> <span class="string">&quot;&forall; &psi;. (&psi; -&gt; &chi;) &ne; &chi;&quot;</span></span><span class="ignored_span"> 
  </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&chi;</span><span class="keyword">,</span> <span class="ident">simp_all</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_B_neq</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> <span class="string">&quot;(\&lt;box&gt; X &phi;) &ne; &phi;&quot;</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BB_neq</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> <span class="string">&quot;([-] X &phi;) &ne; &phi;&quot;</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BBI_neq</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> <span class="string">&quot;([+] X &phi;) &ne; &phi;&quot;</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_not_neq</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> <span class="string">&quot;(&not; &phi;) &ne; &phi;&quot;</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span>

<span class="keyword">--</span><span class="string">"Here's a series of deconstruction lemmas"</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_psform_limp_elim</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> 
 <span class="string">&quot;(&delta; -&gt; &kappa;) &isin; \&lt;Down&gt; &psi; ==&gt; &delta; &isin; \&lt;Down&gt; &psi;&quot;</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&psi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_psform_rimp_elim</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> 
 <span class="string">&quot;(&delta; -&gt; &kappa;) &isin; \&lt;Down&gt; &psi; ==&gt; &kappa; &isin; \&lt;Down&gt; &psi;&quot;</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&psi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_psform_B_elim</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span>
 <span class="string">&quot;\&lt;box&gt; X &psi; &isin; \&lt;Down&gt; &phi; ==&gt; &psi; &isin; \&lt;Down&gt; &phi;&quot;</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_psform_BB_elim</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span>
 <span class="string">&quot;[-] X &psi; &isin; \&lt;Down&gt; &phi; ==&gt; &psi; &isin; \&lt;Down&gt; &phi;&quot;</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_psform_BBI_elim</span><span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span>
 <span class="string">&quot;[+] X &psi; &isin; \&lt;Down&gt; &phi; ==&gt; &psi; &isin; \&lt;Down&gt; &phi;&quot;</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;</span><span class="keyword">,</span> <span class="ident">fastsimp</span><span class="keyword">+</span><span class="keyword">)</span>

<span class="keyword">--</span><span class="string">"All of the above lemmas are used implicitly by what follows:"</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_psform_nin</span> <span class="keyword">[</span><span class="ident">intro</span><span class="keyword">!</span><span class="keyword">]</span><span class="keyword">:</span> <span class="string">&quot;&phi; &notin; \&lt;Down&gt; &phi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&phi;</span><span class="keyword">)</span></span><span class="ignored_span">
       </span><span class="command_span"><span class="command">case</span> <span class="ident">E_P</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="ident">E_Bot</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="ident">E_PP</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_Imp</span> <span class="ident">&psi;</span> <span class="ident">&chi;</span><span class="keyword">)</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">using</span> <span class="ident">evil_limp_neq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&psi;&quot;</span><span class="keyword">]</span> 
          <span class="ident">evil_rimp_neq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">&quot;&chi;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">simp</span><span class="keyword">,</span><span class="ident">blast</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_B</span> <span class="ident">X</span> <span class="ident">&phi;</span><span class="keyword">)</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">using</span> <span class="ident">evil_B_neq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">simp</span><span class="keyword">,</span><span class="ident">blast</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_BB</span> <span class="ident">X</span> <span class="ident">&phi;</span><span class="keyword">)</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">using</span> <span class="ident">evil_BB_neq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">simp</span><span class="keyword">,</span><span class="ident">blast</span><span class="keyword">)</span></span><span class="ignored_span">
 </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_BBI</span> <span class="ident">X</span> <span class="ident">&phi;</span><span class="keyword">)</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">using</span> <span class="ident">evil_BBI_neq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
      </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">simp</span><span class="keyword">,</span><span class="ident">blast</span><span class="keyword">)</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">sub_neq</span> <span class="keyword">[</span><span class="ident">intro</span><span class="keyword">!</span><span class="keyword">]</span><span class="keyword">:</span> 
   <span class="keyword">assumes</span> <span class="ident">sf</span><span class="keyword">:</span> <span class="string">&quot;&psi; &isin; \&lt;Down&gt; &phi;&quot;</span>
     <span class="keyword">shows</span> <span class="string">&quot;&psi; &ne; &phi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">sf</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span"> 
  </span><span class="command_span"><span class="command">from</span> <span class="ident">sf</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&psi; = &phi; --&gt; &phi; &isin; \&lt;Down&gt; &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">auto</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_psform_nin</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">sub_nosub</span> <span class="keyword">[</span><span class="ident">intro</span><span class="keyword">]</span><span class="keyword">:</span> 
  <span class="keyword">assumes</span> <span class="ident">psub</span><span class="keyword">:</span> <span class="string">&quot;&psi; &isin; \&lt;Down&gt; &phi;&quot;</span>
     <span class="keyword">shows</span> <span class="string">&quot;&psi;[&phi;/&chi;] = &psi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">using</span> <span class="ident">psub</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="keyword">(</span><span class="ident">induct</span> <span class="ident">&psi;</span><span class="keyword">)</span></span><span class="ignored_span">
       </span><span class="command_span"><span class="command">case</span> <span class="ident">E_P</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="ident">E_Bot</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="ident">E_PP</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">thus</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_Imp</span> <span class="ident">&delta;</span> <span class="ident">&kappa;</span><span class="keyword">)</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">hence</span> <span class="string">&quot;(&delta; -&gt; &kappa;) &ne; &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">simp</span><span class="keyword">,</span> <span class="ident">blast</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_B</span> <span class="ident">X</span> <span class="ident">&psi;</span><span class="keyword">)</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">hence</span> <span class="string">&quot;\&lt;box&gt; X &psi; &ne; &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">simp</span><span class="keyword">,</span> <span class="ident">blast</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_BB</span> <span class="ident">X</span> <span class="ident">&psi;</span><span class="keyword">)</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">hence</span> <span class="string">&quot;[-] X &psi; &ne; &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">simp</span><span class="keyword">,</span> <span class="ident">blast</span><span class="keyword">)</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">next</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">case</span> <span class="keyword">(</span><span class="ident">E_BBI</span> <span class="ident">X</span> <span class="ident">&psi;</span><span class="keyword">)</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">hence</span> <span class="string">&quot;[+] X &psi; &ne; &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?case</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="keyword">(</span><span class="ident">simp</span><span class="keyword">,</span> <span class="ident">blast</span><span class="keyword">)</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_dneg_eq</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &not; (&not; &phi;) \&lt;leftrightarrow&gt; &phi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span> <span class="keyword">=</span> <span class="string">&quot;(&not;<sub>CL</sub> (&not;<sub>CL</sub> (P#<sub>CL</sub> &phi;)) \&lt;leftrightarrow&gt;<sub>CL</sub> P#<sub>CL</sub> &phi;)&quot;</span></span><span class="ignored_span"> 
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span></span><span class="ignored_span"> 
  </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">text</span> <span class="verbatim">{* After showing all of the above, we have what we need to
  formalize our reasoning about EviL; specifically, we prove versions
  of axioms 13 and 14, an analogue of axiom 8 for @{term "[+] X"},
  and analogues of axioms 4 and 5 for @{term "[-] X"}.  *}</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_dax13</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &lang;+&rang; X ([-] X &phi;) -&gt; &phi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">from</span> <span class="ident">evil_ax13</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; &phi;&quot;</span> <span class="keyword">and</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;(&not; &phi;) &isin; \&lt;Down&gt; (&not; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">sub_nosub</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;(&not; &phi;)[&not; &not; &phi;/ &phi;] = (&not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&perp; &isin; \&lt;Down&gt; (&not; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">sub_nosub</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&perp;[&not; &not; &phi;/ &phi;] = &perp;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span>
    <span class="ident">evil_sub</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; &not; &phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">&quot;&not; &phi; -&gt; [+] X (&lang;-&rang; X (&not; &phi;))&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_not_neq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_dneg_eq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_eq_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &not; &phi; -&gt; [+] X (&not; [-] X &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">auto</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> 
    </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span><span class="keyword">=</span><span class="string">&quot;(&not;<sub>CL</sub> (P#<sub>CL</sub> &phi;) -&gt;<sub>CL</sub> P#<sub>CL</sub> ([+] X (&not; [-] X &phi;)))
            -&gt;<sub>CL</sub> (&not;<sub>CL</sub> (P#<sub>CL</sub> ([+] X (&not; [-] X &phi;))) -&gt;<sub>CL</sub> P#<sub>CL</sub> &phi;)&quot;</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span>
                <span class="ident">evil_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_dax14</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &lang;-&rang; X ([+] X &phi;) -&gt; &phi;&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">from</span> <span class="ident">evil_ax14</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; &phi;&quot;</span> <span class="keyword">and</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;(&not; &phi;) &isin; \&lt;Down&gt; (&not; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">sub_nosub</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;(&not; &phi;)[&not; &not; &phi;/ &phi;] = (&not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&perp; &isin; \&lt;Down&gt; (&not; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">sub_nosub</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&perp;[&not; &not; &phi;/ &phi;] = &perp;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span>
    <span class="ident">evil_sub</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; &not; &phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">&quot;&not; &phi; -&gt; [-] X (&lang;+&rang; X (&not; &phi;))&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_not_neq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_dneg_eq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_eq_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &not; &phi; -&gt; [-] X (&not; [+] X &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">auto</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> 
    </span><span class="command_span"><span class="command">let</span> <span class="var">?&thetasym;</span><span class="keyword">=</span><span class="string">&quot;(&not;<sub>CL</sub> (P#<sub>CL</sub> &phi;) -&gt;<sub>CL</sub> P#<sub>CL</sub> ([-] X (&not; [+] X &phi;)))
            -&gt;<sub>CL</sub> (&not;<sub>CL</sub> (P#<sub>CL</sub> ([-] X (&not; [+] X &phi;))) -&gt;<sub>CL</sub> P#<sub>CL</sub> &phi;)&quot;</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;?&thetasym; &isin; CL&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span> <span class="ident">evil_ClassAx.cl_translate</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;?&thetasym;&quot;</span><span class="keyword">]</span>
                <span class="ident">evil_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BBIax8</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; (\&lt;box&gt; X &phi;) -&gt; [+] X (\&lt;box&gt; X &phi;)&quot;</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">from</span> <span class="ident">evil_ax8</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;diamond&gt; X (&not; &phi;) -&gt; [-] X (\&lt;diamond&gt; X (&not; &phi;))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_DBBI_map</span></span><span class="ignored_span"> 
     </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &lang;+&rang; X (\&lt;diamond&gt; X (&not; &phi;)) -&gt; &lang;+&rang; X ([-] X (\&lt;diamond&gt; X (&not; &phi;)))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ClassAx.hs</span> <span class="ident">evil_dax13</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span> 
                                      <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;\&lt;diamond&gt; X (&not; &phi;)&quot;</span><span class="keyword">]</span></span><span class="ignored_span"> 
     </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &lang;+&rang; X (\&lt;diamond&gt; X (&not; &phi;)) -&gt; \&lt;diamond&gt; X (&not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_mp</span> <span class="ident">evil_ax3</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;[+] X (&not; (\&lt;diamond&gt; X (&not; &phi;)))&quot;</span>
                            <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;\&lt;box&gt; X (&not; &not; &phi;)&quot;</span><span class="keyword">]</span></span><span class="ignored_span">
     </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;box&gt; X (&not; &not; &phi;) -&gt; [+] X (&not; \&lt;diamond&gt; X (&not; &phi;))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;box&gt; X (&not; &not; &phi;) &isin; \&lt;Down&gt; (&not; \&lt;diamond&gt; X (&not; &phi;))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
       </span><span class="command_span"><span class="command">with</span> <span class="ident">sub_nosub</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> 
        <span class="string">&quot;\&lt;box&gt; X (&not; &not; &phi;)[&not; \&lt;diamond&gt; X (&not; &phi;)/\&lt;box&gt; X (&not; &not; &phi;)] = \&lt;box&gt; X (&not; &not; &phi;)&quot;</span></span><span class="ignored_span">
          </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
   </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span>
     <span class="ident">evil_sub</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; \&lt;diamond&gt; X (&not; &phi;)&quot;</span>
                 <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;\&lt;box&gt; X (&not; &not; &phi;)&quot;</span>
                 <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">&quot;\&lt;box&gt; X (&not; &not; &phi;) -&gt; [+] X (&not; \&lt;diamond&gt; X (&not; &phi;))&quot;</span><span class="keyword">]</span>
     <span class="ident">evil_dneg_eq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;\&lt;box&gt; X (&not; &not; &phi;)&quot;</span><span class="keyword">]</span>
     <span class="ident">evil_eq_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; \&lt;box&gt; X (&not; &not; &phi;) -&gt; [+] X (\&lt;box&gt; X (&not; &not; &phi;))&quot;</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span>
    <span class="ident">evil_sub</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; &not; &phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">&quot;\&lt;box&gt; X (&not; &not; &phi;) -&gt; [+] X (\&lt;box&gt; X (&not; &not; &phi;))&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_dneg_eq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_eq_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BBax4</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; [-] X &phi; -&gt; &phi;&quot;</span>
<span class="keyword">--</span><span class="verbatim">{* If @{term &quot;&phi;&quot;} holds no matter what $X$ tries to forget, *}</span>
<span class="keyword">--</span><span class="verbatim">{* then it must be that @{term &quot;&phi;&quot;} holds simpliciter *}</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">from</span> <span class="ident">evil_ax13</span> <span class="ident">evil_ax4</span> <span class="ident">evil_ClassAx.hs</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; (&not; &phi;) -&gt; &lang;-&rang; X (&not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&phi; &isin; \&lt;Down&gt; (&not; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">sub_nosub</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&phi;[&not; &not; &phi;/ &phi;] = &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&perp; &isin; \&lt;Down&gt; (&not; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">with</span> <span class="ident">sub_nosub</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&perp;[&not; &not; &phi;/ &phi;] = &perp;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span>
    <span class="ident">evil_sub</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; &not; &phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">&quot;(&not; &phi;) -&gt; &lang;-&rang; X (&not; &phi;)&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_not_neq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_dneg_eq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_eq_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span>
    <span class="string">&quot;\&lt;turnstile&gt; &not; &phi; -&gt; &not; [-] X &phi;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">auto</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax3</span> <span class="ident">evil_mp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BBdax5</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; &lang;-&rang; X (&lang;-&rang; X &phi;) -&gt; &lang;-&rang; X &phi;&quot;</span>
<span class="keyword">--</span><span class="verbatim">{* If @{term &quot;&phi;&quot;} is true no matter what $X$ *}</span>
<span class="keyword">--</span><span class="verbatim">{* tries to forget, then it's true no matter *}</span>
<span class="keyword">--</span><span class="verbatim">{* what further evidence she disregards *}</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">from</span> <span class="ident">EviL.intros</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; [+] X (&lang;-&rang; X &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax5</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span>
       <span class="ident">evil_ClassAx.hs</span></span><span class="ignored_span"> 
    </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &phi; -&gt; [+] X ([+] X (&lang;-&rang; X &phi;))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_DBB_map</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> 
   <span class="string">&quot;\&lt;turnstile&gt; &lang;-&rang; X (&lang;-&rang; X &phi;) 
      -&gt; &lang;-&rang; X (&lang;-&rang; X ([+] X ([+] X (&lang;-&rang; X &phi;))))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_dax14</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span>
                     <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;[+] X (&lang;-&rang; X &phi;)&quot;</span><span class="keyword">]</span>
       <span class="ident">evil_DBB_map</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span>
       <span class="ident">evil_ClassAx.hs</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &lang;-&rang; X (&lang;-&rang; X &phi;) -&gt; &lang;-&rang; X ([+] X (&lang;-&rang; X &phi;))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_dax14</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span>
                     <span class="keyword">and</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&lang;-&rang; X &phi;&quot;</span><span class="keyword">]</span>
       <span class="ident">evil_DBB_map</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">X</span><span class="keyword">=</span><span class="string">"X"</span><span class="keyword">]</span>
       <span class="ident">evil_ClassAx.hs</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">lemma</span> <span class="ident">evil_BBax5</span><span class="keyword">:</span> <span class="string">&quot;\&lt;turnstile&gt; [-] X &phi; -&gt; [-] X ([-] X &phi;)&quot;</span>
<span class="keyword">--</span><span class="verbatim">{* If @{term &quot;&phi;&quot;} is true no matter what $X$ *}</span>
<span class="keyword">--</span><span class="verbatim">{* tries to forget, then it's true no matter *}</span>
<span class="keyword">--</span><span class="verbatim">{* what further evidence she disregards *}</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">proof</span> <span class="ident">-</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">from</span> <span class="ident">evil_BBdax5</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &lang;-&rang; X (&lang;-&rang; X (&not; &phi;)) -&gt; &lang;-&rang; X (&not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">.</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&perp; &isin; \&lt;Down&gt; (&not; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">hence</span> <span class="string">&quot;&perp;[&not; &not; &phi;/ &phi;] = &perp;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&phi; &isin; \&lt;Down&gt; ([-] X (&not; &not; &phi;))&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">hence</span> <span class="string">&quot;&phi; &ne; [-] X (&not; &not; &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span> 
    <span class="ident">evil_sub</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; &not; &phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">&quot;&lang;-&rang; X (&lang;-&rang; X (&not; &phi;)) -&gt; &lang;-&rang; X (&not; &phi;)&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_dneg_eq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_eq_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span>
    <span class="string">&quot;\&lt;turnstile&gt; &lang;-&rang; X (&not; ([-] X &phi;)) -&gt; &not; ([-] X &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;&perp; &isin; \&lt;Down&gt; (&not; &not; [-] X &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">hence</span> <span class="string">&quot;&perp;[&not; &not; [-] X &phi; / [-] X &phi;] = &perp;&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;(&not; [-] X &phi;) &isin; \&lt;Down&gt; (&not; &not; [-] X &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">simp</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">hence</span> <span class="string">&quot;(&not; [-] X &phi;)[&not; &not; [-] X &phi; / [-] X &phi;] 
           = (&not; [-] X &phi;)&quot;</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">fast</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">moreover</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">note</span> 
    <span class="ident">evil_sub</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;&not; &not; [-] X &phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&psi;</span><span class="keyword">=</span><span class="string">&quot;[-] X &phi;&quot;</span>
                <span class="keyword">and</span> <span class="ident">&chi;</span><span class="keyword">=</span><span class="string">&quot;&lang;-&rang; X (&not; [-] X &phi;) -&gt; (&not; [-] X &phi;)&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_dneg_eq</span> <span class="keyword">[</span><span class="keyword">where</span> <span class="ident">&phi;</span><span class="keyword">=</span><span class="string">&quot;[-] X &phi;&quot;</span><span class="keyword">]</span>
    <span class="ident">evil_eq_mp</span></span><span class="ignored_span">
  </span><span class="command_span"><span class="command">ultimately</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">have</span> <span class="string">&quot;\&lt;turnstile&gt; &not; [-] X ([-] X &phi;) -&gt; &not; ([-] X &phi;)&quot;</span></span><span class="ignored_span">
    </span><span class="command_span"><span class="command">by</span> <span class="ident">fastsimp</span></span><span class="ignored_span"> 
  </span><span class="command_span"><span class="command">with</span> <span class="ident">evil_ax3</span> <span class="ident">evil_mp</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">show</span> <span class="var">?thesis</span></span><span class="ignored_span"> </span><span class="command_span"><span class="command">by</span> <span class="ident">blast</span></span><span class="ignored_span">
</span><span class="command_span"><span class="command">qed</span></span><span class="ignored_span">

</span><span class="command_span"><span class="command">end</span></span></pre>
<hr/>

</div>
</body>
</html>
